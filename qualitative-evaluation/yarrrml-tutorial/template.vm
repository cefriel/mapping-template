@prefix ex: <http://www.example.com/> .
@prefix e: <http://myontology.com/> .
@prefix dbo: <http://dbpedia.org/ontology/> .
@prefix schema: <http://schema.org/> .

#set ($charReader = $functions.getCSVReaderFromFile("people.csv"))
#set ($episodeReader = $functions.getCSVReaderFromFile("episodes.csv"))
#set ($charDF = $charReader.getDataframe())
#set ($episodeDF = $episodeReader.getDataframe())
#set ($mEpisodeAppearences = $functions.getMap($episodeDF, "number"))
##
#foreach($ep in $episodeDF)
ex:episode_$ep.number a schema:Episode .
ex:episode_$ep.number schema:title "$ep.title" .

#end
##
#foreach($char in $charDF)

ex:$char.id a schema:Person ex:Characters .
ex:$char.id schema:givenName "$char.firstname" ex:Characters .
ex:$char.id schema:lastName "$char.lastname" ex:Characters .
ex:$char.id e:debutEpisode "$char.debutEpisode"^^xsd:integer ex:Characters .
ex:$char.id dbo:hairColor "$char.hairColor.toUpperCase()"@en ex:Characters .
#set($tEpisode = $functions.getMapValue($mEpisodeAppearences, $char.debutEpisode))
#if($tEpisode.number) 
ex:$char.id e:appearsIn ex:episode_$tEpisode.number ex:Characters .
ex:$char.id e:appearsIn ex:episode_$tEpisode.number ex:Episodes .
#end
ex:$char.id e:debutEpisode "$char.debutEpisode"^^xsd:integer ex:Episodes .
#end